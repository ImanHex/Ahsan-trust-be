# admin.py
from django.contrib import admin
from django.utils.safestring import mark_safe
from .models import ProductRegistration

# admin.py
criteria_structure = {
    "local Wisdom And Culture": {
        "label": "ภูมิปัญญาและวัฒนธรรมท้องถิ่น",
        "sub_criteria": {
            "halakhProcess": "ใช้กระบวนการฮาลาเกาะฮ์เป็นตัวขับเคลื่อน (อย่างน้อยไตรมาสละ1ครั้ง)",
            "nonMuslimProcess": "หากเป็นศาสนิกอื่นๆที่ไม่ใช่มุสลิม ต้องผ่านกระบวนการฮาลาเกาะฮฺของศูนย์นวัตกรรมอะห์ซานอย่างน้อย2ครั้ง/ปี",
            "localMaterialLabor": "ใช้วัสดุท้องถิ่นอย่างน้อย 1 อย่าง หรือแรงงานท้องถิ่น 40% ของแรงงานทั้งหมด",
            "localWisdom60Years": "ภูมิปัญญาท้องถิ่นที่มีระยะเวลาอย่างน้อย60ปี",
            "halalProduct": "สินค้าประเภทเครื่องใช้: มีกระบวนการผลิตไม่ขัดกับศาสนาอิสลาม หรือต้องได้รับตราฮาลาลจากกรรมการอิสลามประจำจังหวัด หรือสถาบันทางศาสนาอิสลามอื่นๆที่น่าเชื่อถือและยังอยู่ในอายุการใช้งาน",
            "halalFood": "สินค้าประเภทอาหาร: มีกระบวนการผลิตไม่ขัดกับศาสนาอิสลาม หรือต้องได้รับตราฮาลาลจากกรรมการอิสลามประจำจังหวัด",
        }
    },
    "local Labor": {
        "label": "Local Labor",
        "sub_criteria": {
            "รายได้น้อยกว่า 50000 ต่อปี เกิดการจ้างงานเพิ่ม 1 ถึง 2 ครัวเรือน": "รายได้น้อยกว่า 50000 ต่อปี เกิดการจ้างงานเพิ่ม 1 ถึง 2 ครัวเรือน",
            "รายได้ 50000-500000 ต่อปี เกิดการจ้างงานเพิ่ม 3 -9ครัวเรือน": "รายได้ 50000-500000 ต่อปี เกิดการจ้างงานเพิ่ม 3 -9ครัวเรือน",
            "รายได้มากกว่า 500,000  ถึง 1,000,000 ต่อปี เกิดการจ้างงานเพิ่ม 10 -19 ครัวเรือน": "รายได้มากกว่า 500,000  ถึง 1,000,000 ต่อปี เกิดการจ้างงานเพิ่ม 10 -19 ครัวเรือน",
            "รายได้มากกว่า 1,000,000  ถึง 3,000,000 ต่อปี เกิดการจ้างงานเพิ่มไม่น้อยกว่า 20 ครัวเรือน": "รายได้มากกว่า 1,000,000  ถึง 3,000,000 ต่อปี เกิดการจ้างงานเพิ่มไม่น้อยกว่า 20 ครัวเรือน",
            "รายได้มากกว่า  3,000,000  ถึง 5,000,000 ต่อปี เกิดการจ้างงานเพิ่มมากกว่า 20 ถึง 50 ครัวเรือน": "รายได้มากกว่า  3,000,000  ถึง 5,000,000 ต่อปี เกิดการจ้างงานเพิ่มมากกว่า 20 ถึง 50 ครัวเรือน",
            "ครัวเรือนรายได้มากกว่า 5,000,000  ถึง 7,000,000 ต่อปี เกิดการจ้างงานเพิ่ม 50 ถึง 80 ครัวเรือน": "ครัวเรือนรายได้มากกว่า 5,000,000  ถึง 7,000,000 ต่อปี เกิดการจ้างงานเพิ่ม 50 ถึง 80 ครัวเรือน",
            "รายได้มากกว่า  7,000,000  ต่อปี เกิดการจ้างงานเพิ่มไม่น้อยกว่า 80 ครัวเรือน": "รายได้มากกว่า  7,000,000  ต่อปี เกิดการจ้างงานเพิ่มไม่น้อยกว่า 80 ครัวเรือน",
        }
    },
    "Local Economy": {
        "label": "Local Economy",
        "sub_criteria": {
            "รายได้ที่เพิ่มขึ้นของคนในท้องถิ่นเพิ่มขึ้น ร้อยละ5%": "รายได้ที่เพิ่มขึ้นของคนในท้องถิ่นเพิ่มขึ้น ร้อยละ5%",
            "มูลค่าเศรษฐกิจในพื้นที่เพิ่มขึ้น 5 %": "มูลค่าเศรษฐกิจในพื้นที่เพิ่มขึ้น 5 %",
            "การผลิตในแต่ละปี เพิ่มขึ้นร้อยละ5%": "การผลิตในแต่ละปี เพิ่มขึ้นร้อยละ5%",
            "นำผลิตภัณฑ์และบริการใหม่ออกสู่ตลาด": "นำผลิตภัณฑ์และบริการใหม่ออกสู่ตลาด",
            "ปรับปรุงคุณภาพของผลิตภัณฑ์และบริการ": "ปรับปรุงคุณภาพของผลิตภัณฑ์และบริการ",
            "เกิดการขยายตัวการประกอบการชุมชนธุรกิจในท้องถิ่น 5%": "เกิดการขยายตัวการประกอบการชุมชนธุรกิจในท้องถิ่น 5%",
        }
    },
    "Local Networking": {
        "label": "Local Networking",
        "sub_criteria": {
            "ผู้ประกอบการต้องยินยอมร่วมมือกับ AHSAN Trustmark ในการขับเคลื่อนสนับสนุนผู้ประกอบการท้องถิ่นรายอื่นที่มีขนาดเล็กกว่าไม่ต่ำกว่า 1 ราย": "ผู้ประกอบการต้องยินยอมร่วมมือกับ AHSAN Trustmark ในการขับเคลื่อนสนับสนุนผู้ประกอบการท้องถิ่นรายอื่นที่มีขนาดเล็กกว่าไม่ต่ำกว่า 1 ราย",
            "ส่งออกสินค้าและบริการไปยังประเทศอื่นๆเพิ่มขึ้นร้อยละ5 ของการส่งออก/ปี": "ส่งออกสินค้าและบริการไปยังประเทศอื่นๆเพิ่มขึ้นร้อยละ5 ของการส่งออก/ปี",
            "มีจำนวนคู่ค้าทางธุรกิจของตลาด ทั้งในและต่างประเทศเพิ่มขึ้นร้อยละ 5": "มีจำนวนคู่ค้าทางธุรกิจของตลาด ทั้งในและต่างประเทศเพิ่มขึ้นร้อยละ 5",
            "จำนวนการเข้าร่วมงานแสดงสินค้าในและต่างประเทศเพิ่มขึ้นร้อยละ 5": "จำนวนการเข้าร่วมงานแสดงสินค้าในและต่างประเทศเพิ่มขึ้นร้อยละ 5",
        }
    },
    "Local Support": {
        "label": "Local Support",
        "sub_criteria": {
            "ยินดีมอบเงินบริจาค/ซะกาต/ซอดาเกาะ ต่อปี ร้อยละ1 ของรายได้รวม เข้าคลังรับบริจาคของสถาบัน AHSAN Trustmark": "ยินดีมอบเงินบริจาค/ซะกาต/ซอดาเกาะ ต่อปี ร้อยละ1 ของรายได้รวม เข้าคลังรับบริจาคของสถาบัน AHSAN Trustmark",
            "ยินดีมอบเงินจากรายได้ขั้นต้นเพื่อสนับสนุนกิจกรรมสาธารณกุศลหรือวากัฟร้อยละ 1 เข้าคลังรับบริจาคของสถาบัน AHSAN Trustmark": "ยินดีมอบเงินจากรายได้ขั้นต้นเพื่อสนับสนุนกิจกรรมสาธารณกุศลหรือวากัฟร้อยละ 1 เข้าคลังรับบริจาคของสถาบัน AHSAN Trustmark",
        }
    }
}

class ProductRegistrationAdmin(admin.ModelAdmin):
    list_display = ('first_name', 'store_name', 'product_name', 'phone_number', 'display_selected_criteria')

    def display_selected_criteria(self, obj):
        # Create HTML table for criteria
        criteria_table = "<table border='1' cellpadding='5' cellspacing='0' style='border-collapse: collapse;'>"
        criteria_table += "<tr><th>Criteria</th><th>Mark</th></tr>"

        # Loop through each category and sub-criteria
        for category_key, category_data in criteria_structure.items():
            criteria_table += f"<tr><td colspan='2' style='font-weight: bold; background-color: #f0f0f0;'>{category_data['label']}</td></tr>"
            for sub_key, sub_label in category_data["sub_criteria"].items():
                selected = obj.selected_criteria.get(sub_key, False)
                mark = "✔" if selected else "✘"
                criteria_table += f"<tr><td>{sub_label}</td><td style='text-align: center;'>{mark}</td></tr>"

        criteria_table += "</table>"

        # Mark the HTML as safe to render
        return mark_safe(criteria_table)

    display_selected_criteria.short_description = 'Selected Criteria'


admin.site.register(ProductRegistration, ProductRegistrationAdmin)

